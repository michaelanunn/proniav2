"use strict";(()=>{var e={};e.id=374,e.ids=[374],e.modules={2934:e=>{e.exports=require("next/dist/client/components/action-async-storage.external.js")},4580:e=>{e.exports=require("next/dist/client/components/request-async-storage.external.js")},5869:e=>{e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},4300:e=>{e.exports=require("buffer")},8487:(e,o,r)=>{r.r(o),r.d(o,{originalPathname:()=>g,patchFetch:()=>x,requestAsyncStorage:()=>f,routeModule:()=>c,serverHooks:()=>m,staticGenerationAsyncStorage:()=>w});var t={};r.r(t),r.d(t,{GET:()=>p,POST:()=>d});var s=r(9303),i=r(8716),n=r(3131),a=r(344),l=r(1615),u=r(7070);async function d(e,{params:o}){let r=(0,a.createRouteHandlerClient)({cookies:l.cookies}),{username:t}=o;try{let{data:{user:e}}=await r.auth.getUser();if(!e)return u.NextResponse.json({error:"Unauthorized"},{status:401});let{data:o,error:s}=await r.from("profiles").select("id").eq("username",t).single();if(s||!o)return u.NextResponse.json({error:"User not found"},{status:404});let{data:i}=await r.from("follows").select("id").eq("follower_id",e.id).eq("following_id",o.id).single();if(i)return await r.from("follows").delete().eq("follower_id",e.id).eq("following_id",o.id),await r.rpc("decrement_followers",{user_id:o.id}),await r.rpc("decrement_following",{user_id:e.id}),u.NextResponse.json({following:!1});return await r.from("follows").insert({follower_id:e.id,following_id:o.id}),await r.rpc("increment_followers",{user_id:o.id}),await r.rpc("increment_following",{user_id:e.id}),u.NextResponse.json({following:!0})}catch(e){return console.error("Follow API error:",e),u.NextResponse.json({error:e.message},{status:500})}}async function p(e,{params:o}){let r=(0,a.createRouteHandlerClient)({cookies:l.cookies}),{username:t}=o;try{let{data:{user:e}}=await r.auth.getUser();if(!e)return u.NextResponse.json({following:!1});let{data:o}=await r.from("profiles").select("id").eq("username",t).single();if(!o)return u.NextResponse.json({following:!1});let{data:s}=await r.from("follows").select("id").eq("follower_id",e.id).eq("following_id",o.id).single();return u.NextResponse.json({following:!!s})}catch(e){return u.NextResponse.json({following:!1})}}let c=new s.AppRouteRouteModule({definition:{kind:i.x.APP_ROUTE,page:"/api/users/[username]/follow/route",pathname:"/api/users/[username]/follow",filename:"route",bundlePath:"app/api/users/[username]/follow/route"},resolvedPagePath:"C:\\Users\\micha\\Desktop\\pronia_lovable\\src\\app\\api\\users\\[username]\\follow\\route.ts",nextConfigOutput:"",userland:t}),{requestAsyncStorage:f,staticGenerationAsyncStorage:w,serverHooks:m}=c,g="/api/users/[username]/follow/route";function x(){return(0,n.patchFetch)({serverHooks:m,staticGenerationAsyncStorage:w})}}};var o=require("../../../../../webpack-runtime.js");o.C(e);var r=e=>o(o.s=e),t=o.X(0,[948,972,958],()=>r(8487));module.exports=t})();