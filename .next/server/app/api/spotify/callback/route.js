"use strict";(()=>{var e={};e.id=744,e.ids=[744],e.modules={399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},8043:(e,r,t)=>{t.r(r),t.d(r,{originalPathname:()=>f,patchFetch:()=>h,requestAsyncStorage:()=>d,routeModule:()=>p,serverHooks:()=>u,staticGenerationAsyncStorage:()=>l});var o={};t.r(o),t.d(o,{GET:()=>c});var a=t(9303),s=t(8716),i=t(3131),n=t(7070);async function c(e){let r=e.nextUrl.searchParams,t=r.get("code"),o=r.get("error");if(o)return n.NextResponse.redirect(new URL(`/dashboard?spotify_error=${o}`,e.url));if(!t)return n.NextResponse.redirect(new URL("/dashboard?spotify_error=no_code",e.url));try{let r=process.env.SPOTIFY_CLIENT_SECRET,o=await fetch("https://accounts.spotify.com/api/token",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded",Authorization:`Basic ${Buffer.from(`1918e5027cb34632b7b2e21ae5b10cc6:${r}`).toString("base64")}`},body:new URLSearchParams({grant_type:"authorization_code",code:t,redirect_uri:"https://yourdomain.com/api/spotify/callback"})});if(!o.ok){let r=await o.json();return console.error("Spotify token error:",r),n.NextResponse.redirect(new URL("/dashboard?spotify_error=token_failed",e.url))}let a=await o.json(),s=new URL("/dashboard",e.url);return s.searchParams.set("spotify_token",a.access_token),s.searchParams.set("spotify_expires_in",a.expires_in.toString()),n.NextResponse.redirect(s)}catch(r){return console.error("Spotify callback error:",r),n.NextResponse.redirect(new URL("/dashboard?spotify_error=callback_failed",e.url))}}let p=new a.AppRouteRouteModule({definition:{kind:s.x.APP_ROUTE,page:"/api/spotify/callback/route",pathname:"/api/spotify/callback",filename:"route",bundlePath:"app/api/spotify/callback/route"},resolvedPagePath:"C:\\Users\\micha\\Desktop\\pronia_lovable\\src\\app\\api\\spotify\\callback\\route.ts",nextConfigOutput:"",userland:o}),{requestAsyncStorage:d,staticGenerationAsyncStorage:l,serverHooks:u}=p,f="/api/spotify/callback/route";function h(){return(0,i.patchFetch)({serverHooks:u,staticGenerationAsyncStorage:l})}}};var r=require("../../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),o=r.X(0,[948,972],()=>t(8043));module.exports=o})();